<!DOCTYPE html>
<html lang="en">
    {% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Авіаквитки</title>
    <!-- Підключення Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'css/airplanes_tickets.css' %}">
    <link rel="stylesheet" href="{% static 'css/global.css' %}">
    <link rel="icon" type="image/png" href="{% static '/images/favicon.png' %}">
</head>
<body>
    <!-- Навігаційна панель Bootstrap -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light" id="nav-bar">
      <a class="navbar-brand" href="/">
        <img id="main_logo" class="{% if not user.is_authenticated %}not-authenticated{% endif %}" src="{% static '/images/logo.gif' %}">
    </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item {% if request.path == '/' %}active{% endif %}">
                    <a class="nav-link" href="/">
                        <img src="{% if request.path == '/' %}{% static '/images/active-home-icon.svg'%}{% else %}{% static '/images/home-icon.svg' %}{% endif %}" alt = "Головна" class = "nav-icon"> Головна

                    </a>
                </li> 
                <li class="nav-item {% if request.path == '/airplanes/' %}active{% endif %}">
                    <a class="nav-link" href="/airplanes/">
                        <img src="{% if request.path == '/airplanes/' %}{% static '/images/active-airplane-icon.png' %}{% else %}{% static '/images/airplane-icon.png' %}{% endif %}" alt="Авіаквитки" class="nav-icon"> Авіаквитки
                    </a>
                </li>
                <li class="nav-item {% if request.path == '/trains/' %}active{% endif %}">
                    <a class="nav-link" href="/trains/">
                        <img src="{% if request.path == '/trains/' %}{% static '/images/active-train-icon.png' %}{% else %}{% static '/images/train-icon.png' %}{% endif %}" alt="Потяги" class="nav-icon"> Потяги
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.booking.com/" target="_blank">
                        <img src="{% static '/images/hotel-icon.png' %}" alt="Готелі" class="nav-icon"> Готелі
                    </a>
                </li>
            </ul>

            <div class="our_contacts" >
              <a>Наші контакти</a>
            </div>

                <div class="selector_language">
                <div class="container mt-5">
                    <div class="row justify-content-center">
                      <div class="col-md-50">
                        <div class="input-group mb-3">
                          <div class="input-group-prepend ">
                            <!-- Власне зображення глобуса -->
                            <span class="input-group-text"><img src="/static/images/ukrainian_flag.svg" width="24" height="24" alt="Globe" width="24" height="24"></span>
                          </div>
                          <select class="custom-select" id="language-select">

                            <option value="ua">Українська</option>
                            <option value="en">Англійська</option>
                            <!-- Додайте інші мови за потребою -->
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

        </div>
        {% if user.is_authenticated %}
        <!-- Зображення-кнопка для автентифікованого користувача -->
        <img src="{% static 'images/shopping-cart.png' %}" style="margin-right: 20px; margin-left: 10px;" alt="Shopping-cart">
        <img src="{% static 'images/cabinet.png' %}" style="margin-right: 30px;" alt="Cabinet">
    {% else %}
        <button onclick="register_page()" class="register-link">Зареєструватись</button> 
    {% endif %}
    </nav>
    
\

    <div class="form_find_ticket">
      <div style="margin-left: 0px; margin-top: -100px; margin-bottom: 100px; " class="text-top">
        <h1>Купити квиток на літак - легко!</h1>
      </div>
      <form action="{% url 'search_ticket_plane' %}" method="POST">
          <div class="form-row">
              <div class="form-group">
                  <input type="text" id="departure-input" name="departure" class="tickets_info" placeholder="Звідки виліт?" onclick="showDepartureOptions()">
                  <div id="departure-options" class="options-container"></div>
              </div>
              <div class="form-group">
                  <input type="text" id="destination-input" name="destination" class="tickets_info" placeholder="Куди прямуєте?" onclick="showDestinationOptions()">
                  <div id="destination-options" class="options-container"></div>
              </div>
              <div class="form-group">
                  <input type="date" id="departure-date-input" name="departure-date" class="tickets_info">
              </div>
          </div>
          {% if user.is_authenticated %}
          <button type="submit" class="btn btn-primary">Знайти квиток</button>
          {% else %}
          <button type="submit" class="btn btn-primary">Зареєструватись</button>
          {% if messages %}
          <ul class="messages">
              {% for message in messages %}
                  <li{% if message.tags %}  class="{{ message.tags }}"{% endif %}>{{ message }}</li>
              {% endfor %}
          </ul>
        {% endif %}
      </form>
  </div>
  <div style="" class="recent_buyed">
    <h1></h1>
  </div> 
  

    <!-- Підключення скриптів Bootstrap та jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</body>
<script>
// Функція для виконання AJAX запиту
function getDirections() {
  // Виконуємо AJAX запит
  $.ajax({
      url: '/get_directions/',  // URL для запиту на сервер
      type: 'GET',
      success: function(response) {
          // Обробляємо успішну відповідь від серверу
          // Отримуємо список напрямків з відповіді сервера і використовуємо їх
          const directions = response.directions;
          // Відображаємо напрямки у випадаючому меню або робимо що завгодно з ними
          displayDirections(directions);
      },
      error: function(xhr, status, error) {
          // Обробляємо помилку, якщо AJAX запит був неуспішним
          console.error('AJAX error:', status, error);
      }
  });
}

// Функція для відображення напрямків у випадаючому меню
function displayDirections(directions) {
  const departureInput = document.getElementById('departure-input');
  const destinationInput = document.getElementById('destination-input');
  
  // Відображаємо напрямки у випадаючому меню для поля "Звідки виїзд?"
  departureInput.addEventListener('focus', () => {
      showOptions(departureInput, directions);
  });

  // Відображаємо напрямки у випадаючому меню для поля "Куди прямуєте?"
  destinationInput.addEventListener('focus', () => {
      showOptions(destinationInput, directions);
  });
}

// Функція для відображення випадаючого списку напрямків
function showOptions(input, directions) {
  const optionsContainer = input.nextElementSibling;
  optionsContainer.innerHTML = ''; // Очищаємо вміст попередніх варіантів
  
  // Створюємо пункти випадаючого списку для кожного напрямку
  directions.forEach(direction => {
      const option = document.createElement('div');
      option.classList.add('option');
      option.textContent = direction;
      
      // Обробник кліку для встановлення значення поля вводу та приховання списку
      option.addEventListener('click', () => {
          input.value = direction;
          optionsContainer.style.display = 'none';
      });
      
      // Додаємо пункт у випадаючий список
      optionsContainer.appendChild(option);
  });
  
  // Показуємо випадаючий список
  optionsContainer.style.display = 'block';
}

// Викликаємо функцію для отримання напрямків при завантаженні сторінки або при необхідності
$(document).ready(function() {
  getDirections();
});


  function register_page() {
    var url = "http://127.0.0.1:8000/register/"; // Set your desired URL here
    window.location.href = url;
  }

    document.getElementById('language-select').addEventListener('change', function() {
        var flagImg = document.querySelector('.input-group-text img');
        var selectedLanguage = this.value;
        
        // Оновлення зображення прапора залежно від вибраної мови
        switch(selectedLanguage) {
          case 'ua':
            flagImg.src = '/static/images/ukrainian_flag.svg';
            break;
          case 'en':
            flagImg.src = '/static/images/flag_en.svg'; // Припустимо, що у вас є окремі зображення прапорів для кожної мови
            break;

        }
      });

// Отримуємо всі елементи з класом .tickets_info
var ticketInputs = document.querySelectorAll('.tickets_info');

// Об'являємо змінну для збереження значення радіусів границі до фокусу
var previousBorderRadius;

// Перебираємо отримані елементи
ticketInputs.forEach(function(input) {
  // Додаємо подію фокусу
  input.addEventListener('focus', function() {
    // Зберігаємо поточні значення радіусів границі
    previousBorderRadius = {
      borderTopRightRadius: input.style.borderTopRightRadius,
      borderBottomRightRadius: input.style.borderBottomRightRadius,
      borderTopLeftRadius: input.style.borderTopLeftRadius,
      borderBottomLeftRadius: input.style.borderBottomLeftRadius
    };
    // Змінюємо стиль при отриманні фокусу
    input.style.borderTopRightRadius = '10px';
    input.style.borderBottomRightRadius = '10px';
    input.style.borderTopLeftRadius = '10px';
    input.style.borderBottomLeftRadius = '10px';
    input.style.borderColor = '#007acc';
  });

  // Додаємо подію зняття фокусу
  input.addEventListener('blur', function() {
    // Повертаємо радіуси границі до попередніх значень при втраті фокусу
    input.style.borderTopRightRadius = previousBorderRadius.borderTopRightRadius;
    input.style.borderBottomRightRadius = previousBorderRadius.borderBottomRightRadius;
    input.style.borderTopLeftRadius = previousBorderRadius.borderTopLeftRadius;
    input.style.borderBottomLeftRadius = previousBorderRadius.borderBottomLeftRadius;
    input.style.borderColor = '';
  });
});




</script>

</html>
